<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:t="http://java.sun.com/jsf/composite/telveComponents"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                template="/layout/dialogBase.xhtml">

    <ui:param name="title" value="dialog.title.UploadFile" />

    <ui:define name="form" >

        <h:outputStylesheet library="fineuploader" name="fine-uploader-gallery.css" />
        <h:outputScript library="fineuploader" name="fine-uploader.js" />

        <ui:include src="fineUploaderGalleryTemplate.xhtml" />


        <div id="fine-uploader-gallery"></div>

        <script>
            var galleryUploader = new qq.FineUploader({
                element: document.getElementById("fine-uploader-gallery"),
                template: 'qq-template-gallery',
                request: {
                    endpoint: '#{request.contextPath}/upload',
                    params: {
                        raf: "#{fileUploadAction.rafCode}",
                        rafPath: "#{fileUploadAction.uploadPath}"
                    }
                },
                chunking: {
                    enabled: true,
                    mandatory: false,
                    concurrent: {
                        enabled: false
                    },
                    success: {
                        endpoint: "#{request.contextPath}/upload?chunksEnd=1"
                    }
                },
                thumbnails: {
                    placeholders: {
                        waitingPath: '#{request.contextPath}/javax.faces.resource/waiting-generic.png.jsf?ln=fineuploader',
                        notAvailablePath: '#{request.contextPath}/javax.faces.resource/not_available-generic.png.jsf?ln=fineuploader'
                    }
                }/*,
                 validation: {
                 allowedExtensions: ['jpeg', 'jpg', 'gif', 'png']
                 }*/
            });
        </script>

        <div class="row">
            <h:form id="fupl">
            <h:panelGroup styleClass="col-xs-12 actionButtons" layout="block" style="/*position: fixed; bottom: 0; display: block;*/">
                <p:commandLink id="save" action="#{fileUploadAction.closeDialog()}" styleClass="btn btn-primary" process="@this">
                    <i class="fa fa-check" /> #{messages['general.button.Ok']}
                </p:commandLink>
            </h:panelGroup>
            </h:form>
        </div>

        <ui:remove>
            <h:form id="ff" enctype="multipart/form-data">
                <div class="row">

                    <div class="col-xs-12">
                        <span class="text-bold">#{rafContext.collection.title}</span> klasörü içine açılacak
                    </div>

                    <div class="col-xs-12">
                        <p:fileUpload fileUploadListener="#{fileUploadAction.handleFileUpload}" mode="advanced" 
                                      dragDropSupport="true" 
                                      auto="true"
                                      sizeLimit="100000000" allowTypes="/(\.|\/)(.*)$/" />
                    </div>

                </div>
                <div class="row">
                    <h:panelGroup styleClass="col-xs-12 actionButtons" layout="block" style="/*position: fixed; bottom: 0; display: block;*/">
                        <p:commandButton id="save" value="#{messages['general.button.Ok']}" icon="fa fa-check" action="#{fileUploadAction.closeDialog()}" styleClass="btn-primary"/>
                        <p:commandButton id="close" value="#{messages['general.button.Cancel']}" icon="ui-icon-close" action="#{fileUploadAction.cancelDialog()}" process="@this"/>
                    </h:panelGroup>
                </div>
            </h:form>
        </ui:remove>
    </ui:define>

</ui:composition>
