<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:t="http://java.sun.com/jsf/composite/telveComponents"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui"                   
                template="#{themeManager.layoutTemplate}">

    <ui:param name="dontShowContentHeader" value="true" />
    <ui:param name="showContextMenu" value="false" />
    <ui:param name="pageTitle" value="#{rafController.rafDefinition.name}" />

    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="id" value="#{rafController.rafCode}" />
            <f:viewParam name="o" value="#{rafController.objectId}" />
            <f:viewAction action="#{rafController.init()}"/>
        </f:metadata>
    </ui:define>


    <ui:define name="extraHead">
        <h:outputStylesheet library="raf" name="css/raf.css" />
    </ui:define>

    <ui:define name="customHeader">

        <div class="raf-header-container">
            <section class="raf-header">
                <div class="raf-header-logo">
                    <i class="fa fa-3x  fa-archive" style="line-height: 1 !important;"/>
                </div>
                <div class="raf-header-texts">
                    <div class="raf-header-text text-muted text-sm">
                        Raf
                    </div>
                    <div class="raf-header-info text-bold text-big">
                        #{rafController.rafDefinition.name}
                    </div>
                </div>
            </section>
            <section class="raf-header-tools">
                <div class="raf-header-tool-pack">
                    <div class="raf-header-btns">
                        <ui:remove>
                            <p:commandLink action="#{rafController.toggleSideBar()}" update="raf-view">
                                <i class="fa fa-sitemap" />
                            </p:commandLink>

                            <p:commandLink action="#{rafController.createFolder()}" update="raf-view">
                                <i class="fa fa-plus" />
                            </p:commandLink>

                            <p:commandLink action="#{rafDefinitionDialogController.openDialog()}" update="raf-view">
                                <i class="fa fa-plus" />
                            </p:commandLink>
                        </ui:remove>

                        <p:commandLink action="#{rafDefinitionDialogController.openDialog()}" >
                            <i class="fa fa-plus" />
                        </p:commandLink>
                    </div>
                    <div class="raf-header-btns">
                        <ui:remove>
                            <p:commandLink action="#{rafController.setContentView('iconView')}" update="raf-view">
                                <i class="fa fa-th" />
                            </p:commandLink>

                            <p:commandLink action="#{rafController.setContentView('simpleRowView')}" update="raf-view">
                                <i class="fa fa-list" />
                            </p:commandLink>

                            <p:commandLink action="#{rafController.setContentView('detailRowView')}" update="raf-view">
                                <i class="fa fa-th-list" />
                            </p:commandLink>
                        </ui:remove>
                    </div>
                    <div class="raf-header-btns">
                        <a href="" >
                            <i class="fa fa-sitemap" />
                        </a>
                        <a href="" >
                            <i class="fa fa-list" />
                        </a>
                    </div>
                    <div class="raf-header-btns">
                        <div class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                <i class="fa fa-cog"></i>
                            </a>
                            <ul class="dropdown-menu" role="menu">
                                <ui:repeat value="#{rafNavigationController.rafs}" var="raf" >
                                    <li >
                                        <h:link  outcome="/raf.xhtml" title="#{raf.code}">
                                            <i class="fa fa-archive"></i>
                                            <f:param name="id" value="#{raf.code}" />
                                            #{raf.name}
                                        </h:link>
                                    </li>
                                </ui:repeat>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>

    </ui:define>

    <ui:define name="body">
        <ui:include src="/layout/messages.xhtml" />


        <p:outputPanel id="raf-view" class="raf" style="height: 100%;">
            <div class="raf-box left" >
                <div class="raf-box-header">
                    <i class="fa #{rafController.selectedSidePanel.icon}"/>
                    #{rafController.selectedSidePanel.title}

                    <div class="pull-right">

                        <ui:repeat value="#{rafController.sidePanels}" var="sidePanel">
                            <p:commandLink action="#{rafController.setSelectedSidePanel(sidePanel)}" title="#{sidePanel.title}" update="raf-view">
                                <i class="fa #{sidePanel.icon}" /> 
                            </p:commandLink>
                        </ui:repeat>
                    </div>
                </div>
                <div class="raf-box-content" style="">
                    <ui:include src="#{rafController.selectedSidePanel.viewId}" />
                </div>
            </div>

            <p:outputPanel id="raf-view-content" class="raf-box middle">
                <div class="raf-box-header">
                    <i class="fa #{rafController.selectedContentPanel.icon}"/>
                    #{rafController.selectedContentPanel.title}

                    <div class="pull-right">

                        <div style="margin-left: 10px;display: inline-block;">
                            <h:form id="actf" style="display: inline">
                                <ui:repeat value="#{rafController.actions}" var="actGrp">
                                    <div style="margin-left: 10px; display: inline-block;">
                                        <ui:repeat value="#{actGrp}" var="act">

                                            <ui:remove>Not: Confirmation yüzünden böyle garip bişi var!</ui:remove>
                                            <ui:fragment rendered="#{act.supportConfirmation}">
                                                <p:commandLink action="#{act.execute()}" process="@this" ajax="#{act.supportAjax}" update="raf-view" title="#{act.title}"
                                                               disabled="#{not act.isEnabled()}">
                                                    <i class="fa #{act.icon}" />
                                                    <p:confirm header="#{messages['confirmation.header.'.concat(act.name)]}" message="#{messages['confirmation.message.'.concat(act.name)]}" icon="fa fa-alert" />
                                                    <p:ajax event="dialogReturn" update="raf-view" />
                                                </p:commandLink>
                                            </ui:fragment>

                                            <ui:fragment rendered="#{not act.supportConfirmation}">
                                                <p:commandLink action="#{act.execute()}" process="@this" ajax="#{act.supportAjax}" update="raf-view" title="#{act.title}"
                                                               disabled="#{not act.isEnabled()}">
                                                    <i class="fa #{act.icon}" />
                                                    <p:ajax event="dialogReturn" update="raf-view" />
                                                </p:commandLink>
                                            </ui:fragment>


                                        </ui:repeat>
                                    </div>
                                </ui:repeat>
                            </h:form>
                        </div>

                        <ui:remove>
                            <p:commandLink action="#{createFolderAction.execute()}" process="@this" update="raf-view-content" >
                                <i class="fa fa-plus" />
                                <p:ajax event="dialogReturn" update="raf-view" />
                            </p:commandLink>

                            <p:commandLink action="#{fileUploadAction.execute()}" process="@this" update="raf-view-content" >
                                <i class="fa fa-upload" />
                                <p:ajax event="dialogReturn" update="raf-view" />
                            </p:commandLink>
                        </ui:remove>


                        <ui:remove>
                            TODO: Sistemden otomatik olabilecek view tiplerini almak genişleme için olanak sağlar ama şimdilik kapatıyoruz. Diğer sunum tipleri ( icon, table, galery v.b. sonra eklenebilir. )
                            <ui:repeat value="#{rafController.contentPanels}" var="cw" >
                                <p:commandLink action="#{rafController.setSelectedContentPanel(cw)}" process="@this" update="raf-view-content" title="#{cw.actionTitle}">
                                    <i class="fa #{cw.actionIcon}" />
                                </p:commandLink>
                            </ui:repeat>
                        </ui:remove>

                        <ui:fragment rendered="#{rafController.selectedContentPanel.supportMetadata}">
                            <div style="margin-left: 10px; display: inline-block;">
                                <div class="dropdown" style="display: inline-block;">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" title="#{messages['action.addMetadata']}">
                                        <i class="fa fa-cubes" />
                                    </a>
                                    <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                        <ui:repeat value="#{documentViewPanel.additonalMetadatas}" var="md" >
                                            <li>
                                                <p:commandLink action="#{documentViewPanel.addMetadata(md)}" process="@this">
                                                    <i class="fa fa-cube" /> #{md}
                                                    <p:ajax event="dialogReturn" update="raf-view" />
                                                </p:commandLink>
                                            </li>
                                        </ui:repeat>
                                    </ul>
                                </div>

                            </div>
                        </ui:fragment>

                        <div style="margin-left: 10px; display: inline-block;">
                            <div class="dropdown" style="display: inline-block;">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="fa fa-cog"></i>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-right" role="menu">
                                    <li>
                                        <p:commandLink action="#{rafController.toggleShowFolders()}" process="@this" update="raf-view-content">
                                            <i class="fa #{rafController.showFolders ? 'fa-check-square' : 'fa-square-o' }" /> Show Folders
                                        </p:commandLink>
                                    </li>
                                    <li>
                                        <p:commandLink action="#{folderBreadcrumbController.toggleShow()}" process="@this" update="raf-view-content">
                                            <i class="fa #{folderBreadcrumbController.showBreadcrumb ? 'fa-check-square' : 'fa-square-o' }" /> Show Breadcrumb
                                        </p:commandLink>
                                    </li>

                                    <li role="separator" class="divider"></li>

                                    <ui:repeat value="#{rafController.collectionContentPanels}" var="cw" >
                                        <li class="#{rafController.getSelectedContentPanel() eq cw ? 'active' : ''}">
                                            <p:commandLink action="#{rafController.setSelectedContentPanel(cw)}" process="@this" update="raf-view-content" title="#{cw.actionTitle}">
                                                <i class="fa #{cw.actionIcon}" /> #{cw.actionTitle}
                                            </p:commandLink>
                                        </li>
                                    </ui:repeat>
                                    <li role="separator" class="divider"></li>
                                </ul>
                            </div>
                        </div>

                    </div>


                </div>
                <div class="raf-box-content" >
                    <ui:include src="#{rafController.selectedContentPanel.viewId}" />
                </div>
                <ui:fragment rendered="#{rafController.selectedContentPanel.supportPaging}">
                    <div class="raf-box-footer" style="text-align: center">
                        <ul class="pagination pagination-sm" style="margin: 0px; display: inline;">
                            <li class="active"><a href="#">1</a></li>
                            <li><a href="#">2</a></li>
                            <li><a href="#">3</a></li>
                            <li><a href="#">4</a></li>
                            <li><a href="#">5</a></li>
                            <li><a href="#">6</a></li>
                            <li><a href="#">7</a></li>
                        </ul>
                    </div>
                </ui:fragment>

                <script type="text/javascript">
                    /*contentSection*/
                    var clientHeight = jQuery(window).height() - 150;
                    jQuery('#contentSection').css('height', clientHeight);

                    jQuery('.raf-box-content').css('max-height', clientHeight - 30);
                </script>
            </p:outputPanel>
        </p:outputPanel>



    </ui:define>


</ui:composition>