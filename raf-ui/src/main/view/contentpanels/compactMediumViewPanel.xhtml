<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:t="http://java.sun.com/jsf/composite/telveComponents"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://primefaces.org/ui">

    <ui:fragment rendered="#{compactMediumViewPanel.supportBreadcrumb}" >
        <ui:include src="/fragments/breadcrumb.xhtml" >
            <ui:param name="forCollection" value="true" />
        </ui:include>

    </ui:fragment>
    <div class="content-view-port">
    <div class="raf-container" >
        <ui:repeat value="#{compactMediumViewPanel.collection.items}" var="item" >
            <div class="raf-container-item">
                <div class="raf-container-item-item medium-icon">
                    <span class="raf-container-item-item-img" >
                        <div class="raf-container-item-item-chk #{rafSelectionController.isSelected(item) ? 'raf-item-selected' : ''}">
                            <p:commandLink action="#{rafSelectionController.toggle(item)}" 
                                           update="raf-view-content" ajax="true" process="@this" 
                                           >
                                <i class="fa #{iconResolver.getIcon(item.mimeType)} fa-2x" />
                            </p:commandLink>
                        </div>
                    </span>
                    <span class="raf-container-item-item-cnd">
                        <p:commandLink action="#{rafController.selectItem(item)}" update="raf-view" ajax="true" process="@this" styleClass="text-sm">
                            <span class="text-sm">#{item.title}</span>
                        </p:commandLink>

                        <div class="text-muted text-sm">#{item.name}</div>
                        <div class="text-muted text-sm">
                            #{userLookup.getUserName(item.createBy)} | <t:cellOutputDateTime value="#{item.createDate}"/>
                        </div>

                        <ui:remove>
                            <ui:fragment rendered="#{not empty item.info}">
                                <div class="text-muted text-sm"><i class="fa fa-info" /> #{item.info}</div>
                            </ui:fragment>


                            <ui:fragment rendered="#{not empty item.category}">
                                <div class="text-muted text-sm"><i class="fa fa-sitemap" /> #{item.category}</div>
                            </ui:fragment>

                            <ui:fragment rendered="#{not empty item.tags}">
                                <div class="text-muted text-sm">
                                    <p:repeat value="#{item.tags}" var="tag">
                                        <i class="fa fa-tag" /> #{tag}
                                    </p:repeat>
                                </div>
                            </ui:fragment>
                        </ui:remove>

                    </span>
                </div>
            </div>
        </ui:repeat>
    </div>
    </div>
    <ui:remove>
        <ul class="raf-item-row-list">

            <ui:repeat value="#{compactMediumViewPanel.collection.items}" var="item" >
                <li class="raf-item">
                    <div class="raf-item-content">

                        <p:commandLink action="#{rafSelectionController.toggle(item)}" update="raf-view-content" ajax="true" process="@this" styleClass="btn btn-box-tool" style="margin-right: 4px;">
                            <i class="fa #{rafSelectionController.isSelected(item) ? 'fa-check-square' : 'fa-square-o'}" />
                        </p:commandLink>

                        <span class="raf-item-image">
                            <i class="fa #{iconResolver.getIcon(item.mimeType)} fa-2x" />
                        </span>
                        <div class="raf-item-name">
                            <p:commandLink action="#{rafController.selectItem(item)}" update="raf-view" ajax="true" process="@this" styleClass="text-sm">
                                <span class="text-sm">#{item.title}</span>
                            </p:commandLink>
                            <span class="text-muted text-sm">
                                #{item.info} <ui:remove>| #{userLookup.getUserName(item.createBy)} | <t:cellOutputDateTime value="#{item.createDate}"/></ui:remove>
                            </span>
                        </div>

                        <div class="raf-item-name" style="margin-left: 8px;">
                            <div class="text-muted text-sm"><i class="fa fa-sitemap" /> #{item.category}</div>
                            <div class="text-muted text-sm">
                                <p:repeat value="#{item.tags}" var="tag">
                                    <i class="fa fa-tag" /> #{tag}
                                </p:repeat>
                            </div>
                        </div>
                    </div>

                    <div class="raf-item-tools">
                        <ui:remove>FIXME: Yetki kontrol√º</ui:remove>

                        <ui:fragment rendered="#{item.mimeType ne 'raf/folder'}">
                            <h:form id="ff" style="display: inline;">
                                <p:commandLink action="#{downloadAction.downloadFile(item)}" update="raf-view" ajax="false" process="@this" styleClass="btn btn-box-tool">
                                    <i class="fa fa-download" />
                                </p:commandLink>
                            </h:form>
                            <p:commandLink action="#{rafController.selectItem(item)}" update="raf-view" ajax="true" process="@this" styleClass="btn btn-box-tool">
                                <i class="fa fa-edit" />
                            </p:commandLink>
                            <p:commandLink action="#{deleteAction.deleteObject(item)}" process="@this" ajax="true" update="raf-view" title="#{deleteAction.title}" styleClass="btn btn-box-tool">
                                <i class="fa fa-trash" />
                                <p:confirm header="#{messages['confirmation.header.DeleteAction']}" message="#{messages['confirmation.message.DeleteAction']}" icon="fa fa-alert" />
                            </p:commandLink>
                        </ui:fragment>

                        <ui:fragment rendered="#{item.mimeType eq 'raf/folder'}">
                            <p:commandLink action="#{rafController.selectFolderItem(item)}" update="raf-view" ajax="true" process="@this" styleClass="btn btn-box-tool">
                                <i class="fa fa-edit" />
                            </p:commandLink>

                            <p:commandLink action="#{deleteAction.deleteObject(item)}" process="@this" ajax="true" update="raf-view" title="#{deleteAction.title}" styleClass="btn btn-box-tool">
                                <i class="fa fa-trash" />
                                <p:confirm header="#{messages['confirmation.header.DeleteAction']}" message="#{messages['confirmation.message.DeleteAction']}" icon="fa fa-alert" />
                            </p:commandLink>
                        </ui:fragment>
                    </div>
                </li>
            </ui:repeat>
        </ul>
    </ui:remove>
</ui:composition>

